# 使用指南：

加载后使用命令/function gun:gun/get即可获取gun和ammo

get获取的胡萝卜钓竿和弹药用原版的来代替都可以！

但是注意换弹会清理副手所有的火药，这个目前还没有优化




# 数据包介绍
（感谢AnichHaveatry提供的使用AI生成的介绍，本人日后有空会写一份简单点的:D）

## 数据包基本信息

这是一个适用于Minecraft 1.21.3版本的枪械主题数据包。根据pack.mcmeta文件中的描述，该数据包的主要功能是在游戏中实现枪械系统。数据包使用了Minecraft的记分板(scoreboard)系统、函数(function)系统和标签(tags)系统来实现复杂的枪械机制。

## 数据包结构分析

数据包采用了标准的Minecraft数据包结构，主要包含以下部分：

1. 根目录下的pack.mcmeta和pack.png文件，定义了数据包的基本信息和图标。
2. data/gun/function目录，包含了所有的功能函数文件。
3. data/gun/tags目录，定义了特定方块和实体的分类。
4. data/minecraft/tags/function目录，用于将数据包的函数挂载到Minecraft的加载和循环系统中。

## 核心功能实现机制

### 初始化系统

数据包在加载时通过load.mcfunction文件初始化所有必要的记分板和玩家状态：

- 创建use_gun记分板，用于检测玩家使用胡萝卜钓竿的动作
- 创建gun_cooldown记分板，管理射击冷却时间
- 创建ammo记分板，记录玩家当前弹药数量
- 创建reloading记分板，标记玩家是否正在装弹
- 创建reload_cooldown记分板，管理装弹冷却时间
- 初始化玩家的reloading和reload_cooldown值为0
- 向所有玩家发送数据包加载成功的消息

### 主循环系统

数据包通过tick.mcfunction文件实现每游戏刻(tick)的主循环逻辑：

- 检测玩家右键胡萝卜钓竿的动作，触发射击函数
- 重置右键检测计数
- 处理射击冷却时间倒计时
- 检测玩家副手持有火药时触发装弹函数
- 为持有胡萝卜钓竿的玩家显示弹药信息
- 处理装弹冷却时间倒计时
- 防止猪被胡萝卜钓竿吸引（通过设置NoAI标签）

### 射击系统

射击功能通过shoot.mcfunction实现，主要逻辑包括：

- 检查玩家是否处于射击冷却状态，如是则取消射击
- 检查玩家是否正在装弹，如是则取消射击
- 检查玩家是否有弹药，如无则取消射击
- 减少玩家弹药数量
- 播放射击音效（爆炸声，音量0.5，音调2）
- 设置射击冷却时间为1个tick
- 调用子弹光线追踪函数，从玩家眼睛位置（高度+0.7）开始

### 子弹系统

子弹系统通过多个函数协同工作：

1. bullet_raycast.mcfunction：实现子弹光线追踪
   - 限制射程为15格
   - 检测是否命中敌对生物
   - 生成粒子效果模拟子弹轨迹
   - 检查当前方块是否可穿透，如可穿透则继续前进0.5格并递归调用自身

2. bullet_hit.mcfunction：处理子弹命中敌对生物的效果
   - 对命中的敌对生物造成7点玩家攻击伤害
   - 播放命中音效（箭命中玩家和生物受伤的声音）
   - 代码中包含被注释的击退效果实现

### 装弹系统

装弹系统通过多个函数协同工作：

1. reload.mcfunction：触发装弹过程
   - 检查玩家是否已在装弹状态，如是则取消
   - 检查装弹冷却时间，如未结束则取消
   - 设置玩家装弹状态为1
   - 清除玩家副手中的物品（火药）
   - 播放装弹音效（弩装填中段声音）
   - 设置装弹冷却时间为40个tick（2秒）
   - 调用reloading函数开始装弹倒计时

2. reloading.mcfunction：处理装弹倒计时
   - 减少正在装弹玩家的reload_cooldown计数
   - 当reload_cooldown降至0时，调用reload_complete函数

3. reload_complete.mcfunction：完成装弹过程
   - 重置玩家装弹状态为0
   - 设置玩家弹药数量为30发
   - 向玩家显示"装弹完成！"的绿色消息

### 弹药显示系统

通过display_ammo.mcfunction实现：
   - 在玩家动作栏显示当前弹药数量
   - 当玩家不再手持胡萝卜钓竿时，移除显示标签并清空动作栏

### 标签配置

数据包使用了两个自定义标签来优化功能：

1. non_solid.json：定义了子弹可穿透的方块类型
   - 包括空气、水、岩浆、花、火把、高草和矮草

2. hostile.json：定义了可被子弹伤害的敌对生物类型
   - 包括僵尸、骷髅、苦力怕、掠夺者和蜘蛛

## 游戏交互方式

1. 玩家需要手持胡萝卜钓竿作为枪械
2. 副手持有火药时可以进行装弹
3. 右键点击胡萝卜钓竿进行射击
4. 动作栏会显示当前弹药数量
5. 装弹需要2秒时间，完成后会获得30发弹药
6. 射击有极短的冷却时间（1个tick）
7. 子弹最大射程为15格，可穿透特定非固体方块
8. 命中敌对生物会造成7点伤害并播放命中音效

## 技术特点

1. 使用记分板系统管理状态和计时器
2. 使用递归函数实现子弹光线追踪
3. 使用标签系统定义特殊方块和实体组
4. 使用动作栏显示实时弹药信息
5. 使用粒子效果模拟子弹轨迹
6. 通过NoAI标签防止胡萝卜钓竿对猪的影响

## 总结

这个数据包巧妙地利用了Minecraft原版机制，在不需要任何模组的情况下实现了一个功能完整的枪械系统。它通过胡萝卜钓竿作为枪械，火药作为弹药，结合记分板、函数和标签系统，实现了射击、装弹、弹药管理、子弹轨迹和伤害效果等功能。数据包的设计考虑了游戏平衡性，包括射程限制、冷却时间和装弹延迟等机制，同时也注重了游戏体验，添加了音效和粒子效果增强沉浸感。
